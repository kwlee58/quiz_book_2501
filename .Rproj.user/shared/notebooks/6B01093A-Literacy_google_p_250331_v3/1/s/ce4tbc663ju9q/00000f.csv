"0","library(tidyverse)"
"0","pos <- {. %>% {cumsum(.) - `/`(., 2)}}"
"0","x_text <- apply(literacy_tbl, MARGIN = 2, FUN = pos)"
"0","#> literacy_tbl을 깔끔한 데이터로 변환"
"0","literacy_tbl2 <- literacy_tbl %>%"
"0","  as_tibble %>%"
"0","#> Item 변수 설정"
"0","  mutate(Item = row.names(literacy_tbl)) %>%"
"0","#> Item은 빼고, key, value 쌍으로 변환, "
"0","  gather(key = Questions, value = Counts, -Item) %>%"
"0","#> factor로 변환"
"0","  mutate(Questions = factor(Questions, levels = paste0(""Q"", 1:25))) %>%"
"0","  mutate(Item = factor(Item)) %>%"
"0","#> 라벨의 좌표와 라벨을 컬럼 단위로 펴서, 깔끔한 tibble에 별도의 벡터로 추가"
"0","  mutate(x_text = c(x_text), label_ptbl = c(label_ptbl))"
"0","#> ggplot layout 설정. 공통적으로 등장하는 x 좌표도  포함시킨다."
"0","ggplot(data = literacy_tbl2, mapping = aes(x = Questions)) +"
"0","#> Counts 를 Item별로 막대그래프에 쌓아올린다. 순서는 1, 2, 3, 4 순 (reverse = TRUE)."
"0","#> stat = ""identity"" 는 디폴트이므로 굳이 설정하지 않아도 무방. "
"0","  geom_bar(aes(y = Counts, fill = Item),"
"0","           col = ""black"", linewidth = 0.3,"
"0","           stat = ""identity"", position = position_stack(reverse = TRUE)) +"
"0","#> 퍼센티지를 추가 정보로 각 막대의 중점에 표시. mapping = aes() 에서 공통되는 x 좌표 설정은 생략 가능."
"0","  geom_text(aes(y = x_text, label = label_ptbl)) +"
"0","#> fill 의 색깔과 레전드 제목 설정."
"0","  scale_fill_brewer(name = ""답문항"", type = ""qual"", palette = ""Accent"") +"
"0","#> 제목과 x축 라벨, y축 라벨 설정."
"0","  labs(title = ""문해력조사 문항별 응답"", x = ""문항"", y = ""백분율"") +"
"0","#  xlab(""문제"") +"
"0","#  ylab(""백분율"") +"
"0","#  ggtitle(""문해력조사 문항별 응답"") + "
"0","#> 플롯 배경에 설정된 격자를 최소로 theme 설정"
"0","  theme_minimal(base_family = ""kopub"") +"
"0","#> 격자의 주요 선 없애고,"
"0","  theme(panel.grid = element_blank(),"
"0","#> 플롯 제목의 폰트, 폰트 크기, 가운데 정렬 설정"
"0","        plot.title = element_text(family = ""kopub"", face = ""bold"", size = 18, hjust = 0.5),"
"0","#> 레전드에 박스 두르기"
"0","        legend.background = element_rect(fill = ""transparent""),"
"0","#> 레전드의 제목 폰트 설정"
"0","        legend.title = element_text(family = ""kopub""),"
"0","#> x축 라벨의 폰트 설정"
"0","        axis.title.x = element_text(family = ""kopub""),"
"0","#> x축 눈금 텍스트를 없앰 (너무 떨어져 있어서 새로 설정할 예정)"
"0","        axis.text.x = element_blank(),"
"0","#> y축 라벨의 폰트 설정. ""문항""을 좀더 축에 가까이 보내고 싶지만 잘 안됨."
"0","        axis.title.y = element_text(family = ""kopub""),"
"0","#> y축 눈금 텍스트 없애기"
"0","        axis.text.y = element_blank()) +"
"0","#> x축의 라벨을 막대에 보다 가깝게 조정 (flip해서 x축을 수직으로 세울 예정이므로 y = -30)"
"0","  geom_text(mapping = aes(y = -15, label = Questions)) "
